<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Tremor Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Tremor Blog Atom Feed"><title data-react-helmet="true">Modular Queries | Tremor</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://www.tremor.rs//rfc/implemented/modular-queries"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-rfc-current"><meta data-react-helmet="true" property="og:title" content="Modular Queries | Tremor"><meta data-react-helmet="true" name="description" content="- Feature Name: rfc-0014-modular-queries"><meta data-react-helmet="true" property="og:description" content="- Feature Name: rfc-0014-modular-queries"><link data-react-helmet="true" rel="shortcut icon" href="/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://www.tremor.rs//rfc/implemented/modular-queries"><link data-react-helmet="true" rel="alternate" href="https://www.tremor.rs//rfc/implemented/modular-queries" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://www.tremor.rs//rfc/implemented/modular-queries" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.b987a0a0.css">
<link rel="preload" href="/assets/js/runtime~main.91f82e5b.js" as="script">
<link rel="preload" href="/assets/js/main.98e9b71b.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.tremor.rs/" target="_self" rel="noopener noreferrer" class="navbar__brand"><img src="/img/tremor-logo.svg" alt="Tremor Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/tremor-logo.svg" alt="Tremor Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a class="navbar__item navbar__link" href="/docs/next/getting-started/getting-started">Getting Started</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/community/community">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/community/community">Overview</a></li><li><a href="https://chat.tremor.rs" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Chat<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a class="dropdown__link" href="/community/governance">Governance</a></li><li><a class="dropdown__link" href="/community/faqs">FAQs</a></li><li><a class="dropdown__link" href="/rfc/index">RFCs</a></li><li><a class="dropdown__link" href="/community/EventsAndMedia">Events and Media</a></li></ul></div><a class="navbar__item navbar__link" href="/docs/index">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/docs/index">0.11</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/getting-started/getting-started">Next</a></li><li><a class="dropdown__link" href="/docs/index">0.11</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://chat.tremor.rs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discord-link" aria-label="Community Chat"></a><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/rfc/index">RFCs</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Accepted</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Implemented</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rfc/implemented/remove-actix-from-tremor-runtime">Remove Actix</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rfc/implemented/linked-transports">Linked Transports</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rfc/implemented/circuit-breaker-mechanism">Circuit Breaker Mechanism</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rfc/implemented/pipeline-optimizations">Pipeline Optimisations</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rfc/implemented/onramp-postgres">Onramp Postgres</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rfc/implemented/modularity">Modularity</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rfc/implemented/string-interpolation">String Interpolation</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/rfc/implemented/correlation">Correlation</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rfc/implemented/modular-queries">Modular Queries</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">RFC Process</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Modular Queries</h1></header><ul><li>Feature Name: rfc-0014-modular-queries</li><li>Start Date: 2021-07-24</li><li>Tremor Issue: <a href="https://github.com/tremor-rs/tremor-runtime/issues/940" target="_blank" rel="noopener noreferrer">tremor-rs/tremor-runtime#940</a></li><li>RFC PR: <a href="https://github.com/tremor-rs/tremor-rfcs/pull/55" target="_blank" rel="noopener noreferrer">tremor-rs/tremor-rfcs#55</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="summary"></a>Summary<a class="hash-link" href="#summary" title="Direct link to heading">#</a></h2><p>Add support for modular queries to Tremor&#x27;s query language, Trickle, so that distinct subgraphs could be reused and composed into higher level queries.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="motivation"></a>Motivation<a class="hash-link" href="#motivation" title="Direct link to heading">#</a></h2><p>Subqueries would allow composition of smaller, reusable queries into higher level queries.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="guide-level-explanation"></a>Guide-level explanation<a class="hash-link" href="#guide-level-explanation" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="definition"></a>Definition<a class="hash-link" href="#definition" title="Direct link to heading">#</a></h3><p><img alt="DefineSubqueryDefn" src="/assets/images/DefineSubqueryDefn-264b8961950ecb290af62524d174b14d.png"></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">DefineSubqueryDefn ::= DocComment? &#x27;define&#x27; &#x27;query&#x27; Id (&#x27;from&#x27; Ports)? (&#x27;into&#x27; Ports)? WithPartialParams? Subquery</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">define query custom_subquery</span></span><span class="token-line" style="color:#393A34"><span class="token plain">## Documentation Comment</span></span><span class="token-line" style="color:#393A34"><span class="token plain">from input_stream_1, input_stream_2</span></span><span class="token-line" style="color:#393A34"><span class="token plain">into output_stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">with</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> param1 = &quot;foo&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> param2 = 42</span></span><span class="token-line" style="color:#393A34"><span class="token plain">query</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> select event from input_stream_1 where event.name == args.param1 into output_stream;</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> select event from input_stream_2 where event.id == args.param2 into output_stream;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>The <code>with</code> clause can be used to pass in parameters when required.<ul><li>The values given to the parameters in the with clause here act as their default values.</li><li>Parameters are accessible through <code>args</code> inside the subquery.</li></ul></li><li>The <code>from</code> clause can be used to define input streams.<ul><li>If elided, <code>in</code> stream is attached.</li></ul></li><li>The <code>into</code> clause can be used to define output streams.<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">- If elided, `out` and `err` streams are attached.  </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><strong>Note</strong><ul><li>Although there are currently no restrictions on sending events into the <code>input_stream</code> or reading from the <code>output_stream</code>, it is <strong>not</strong> recommended to do so.</li><li>The streams named inside the <code>from</code> and <code>into</code> clauses are created inside the subquery implicitly. i.e. there is no need to <code>create stream output_stream</code> inside the subquery.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="creation"></a>Creation<a class="hash-link" href="#creation" title="Direct link to heading">#</a></h3><p><img alt="CreateSubqueryDefn" src="data:image/png;base64,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"></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">CreateSubqueryDefn ::= &#x27;create&#x27; &#x27;query&#x27; Id ( &#x27;from&#x27; ModularId )? WithParams?</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain"># Short form</span></span><span class="token-line" style="color:#393A34"><span class="token plain">create query custom_subquery;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># Full form</span></span><span class="token-line" style="color:#393A34"><span class="token plain">create query my_custom_subq from custom_subquery</span></span><span class="token-line" style="color:#393A34"><span class="token plain">with</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> param1 = &quot;bar&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>The short form can be used if you don’t need to give the subquery a custom id.<ul><li>The <code>id</code> from the subquery definition is used, ie <code>custom_subquery</code> in this case.</li></ul></li><li>The full form allows you to give a custom id to the subquery.</li><li>The <code>with</code> clause can be used with either form to specify some or all of the parameters. Default values from the definition will be used for those left unspecified.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="use"></a>Use<a class="hash-link" href="#use" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">select event from in into my_custom_subq/input_stream_1;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from in into my_custom_subq/input_stream_2;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from my_custom_subq/output_stream into out;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>We need to explicitly specify the ports with <code>my_custom_subq</code>  here because the subquery is not using the default <code>in</code>, <code>out</code> or <code>err</code> ports.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="example-1"></a>Example 1<a class="hash-link" href="#example-1" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">mod library with</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> mod utils with</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   define script mark_malformed</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   script</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     emit {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;event&quot;: event,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;status&quot;: &quot;malformed&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   } =&gt; &quot;invalid&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   end;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   define query select_minage</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     with</span></span><span class="token-line" style="color:#393A34"><span class="token plain">       age = 18 # Parameter with default value of `18`</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     query</span></span><span class="token-line" style="color:#393A34"><span class="token plain">       select event from in where in.age &gt;= args.age into out;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   end;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> end;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> define query select_valid_people</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> with</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   age = 21,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   placeholder_name = &quot;NA&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> query</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   use utils;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   create script mark_malformed;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   create query select_min_age</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   with</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     age = args.age </span></span><span class="token-line" style="color:#393A34"><span class="token plain">   end;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   select event from in into select_min_age;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   select event from select_min_age where event.name != args.placeholder_name into out;</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain">   select event from select_min_age where event.name == args.placeholder_name into mark_malformed;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   select event from mark_malformed/invalid into err;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">create query valid_over_21 from library::select_valid_people</span></span><span class="token-line" style="color:#393A34"><span class="token plain">with</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> placeholder_name = &quot;John Doe&quot; # Overrides the default value of &quot;NA&quot;.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select from in into valid_over_21;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select from valid_over_21 into out;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select from valid_over_21/err into err;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># Routes all events with age&gt;=21 and name!=&quot;John Doe&quot; to out</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># Events with age&lt;=21 are ignored</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># Events with name==&quot;John Doe&quot; are marked as malformed and routed to err</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Here, we have a subquery, <code>valid_over_21</code>, defined in the <code>library</code> module. The subquery itself is composed out of more generic components defined in the <code>utils</code> module and overrides their defaults with its own where appropriate.</p><ul><li><strong>Note</strong><ul><li>It&#x27;s not possible to access the <code>mark_malformed/invalid</code> stream from outside the subquery unless it&#x27;s connected to <code>err</code> (or any other <code>into</code>) port.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="example-2"></a>Example 2<a class="hash-link" href="#example-2" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">define query custom_subquery</span></span><span class="token-line" style="color:#393A34"><span class="token plain">with</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> interval = core::datetime::with_seconds(60),</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> minimum_count = 0</span></span><span class="token-line" style="color:#393A34"><span class="token plain">query</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> define tumbling window interval_window</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> with</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     interval = args.interval</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> end;</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> select aggr::stats::hdr(event.count)</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> from in[interval_window]</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> group by each(event.topic)</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> into out</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> having count &gt; args.minimum_count;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">create query six_per_two_minutes from custom_subquery</span></span><span class="token-line" style="color:#393A34"><span class="token plain">with</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> interval = core::datetime::with_seconds(120),</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> minimum_count = 6</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The <code>custom_subquery</code> defined here contains its own scoped definition of a tumbling window, <code>interval_window</code>. This window is not accessible outside the subquery.</p><ul><li><strong>Note</strong><ul><li>While it&#x27;s possible to define and create a component inside a subquery, it&#x27;s <strong>not</strong> possible to pass in an externally created component as a parameter.</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="reference-level-explanation"></a>Reference-level explanation<a class="hash-link" href="#reference-level-explanation" title="Direct link to heading">#</a></h2><p>The subqueries syntax builds upon the existing modularity features to enable the composition of smaller components into higher level queries. During the construction of the DAG nested subqueries are, recursively, flattened and inlined into their parent Query.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="grammar-changes"></a>Grammar Changes<a class="hash-link" href="#grammar-changes" title="Direct link to heading">#</a></h3><ul><li><strong>Stmt</strong><ul><li>Two new statement types are introduced in <code>Stmt</code> for defining and creating subqueries.</li><li><img alt="Stmt" src="/assets/images/Stmt-a919cb8e6dc1d43a09d4c0755f634e7e.png"></li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Stmt ::= </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ModuleStmt</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    | DefineWindowDefn</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    | CreateStreamDefn</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    | DefineOperatorDefn</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    | CreateOperatorDefn</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    | DefineScriptDefn</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    | CreateScriptDefn</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    | DefineSubqueryDefn  // New</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    | CreateSubqueryDefn  // New</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    | SelectStmt</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li><strong>ModuleStmtInner</strong><ul><li>The definition of <code>ModuleStmtInner</code> is extended to include subquery definitions.</li><li><img alt="ModuleStmtInner" src="/assets/images/ModuleStmtInner-b9b08f2697f190d2c2516d51ccddbf66.png"></li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">ModuleStmtInner ::=</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ModuleStmt</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    | DefineWindowDefn</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    | DefineOperatorDefn</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    | DefineScriptDefn</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    | DefineSubqueryDefn  // New</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="grammar-additions"></a>Grammar Additions<a class="hash-link" href="#grammar-additions" title="Direct link to heading">#</a></h3><ul><li> <strong>CreateSubqueryDefn</strong><ul><li>A new keyword <code>query</code> is introduced.</li><li><img alt="CreateSubqueryDefn" src="data:image/png;base64,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"></li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">CreateSubqueryDefn ::= &#x27;create&#x27; &#x27;query&#x27; Id ( &#x27;from&#x27; ModularId )? WithParams?</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li> <strong>DefineSubqueryDefn</strong><ul><li><img alt="DefineSubqueryDefn" src="/assets/images/DefineSubqueryDefn-264b8961950ecb290af62524d174b14d.png"></li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">DefineSubqueryDefn ::= DocComment? &#x27;define&#x27; &#x27;query&#x27; Id (&#x27;from&#x27; Ports)? (&#x27;into&#x27; Ports)? WithPartialParams? Subquery</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li><strong>Ports</strong><ul><li><img alt="Ports" src="data:image/png;base64,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"></li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Ports ::= Id &#x27;,&#x27; Ports | Id</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li><strong>Subquery</strong><ul><li><img alt="Subquery" src="data:image/png;base64,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"></li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Subquery ::= &#x27;query&#x27; SubqueryStmtInner &#x27;end&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li><strong>SubqueryStmtInner</strong><ul><li>Currently, the definition of  <code>SubqueryStmtInner</code> is equivalent to that of <code>Query</code>.</li><li><img alt="SubqueryStmtInner" src="data:image/png;base64,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"></li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">SubqueryStmtInner ::= ( Stmt &#x27;;&#x27; )+ | Stmt</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="drawbacks"></a>Drawbacks<a class="hash-link" href="#drawbacks" title="Direct link to heading">#</a></h2><ul><li>Introduction of subqueries would encourage deeper nesting which might increase compile time complexity.</li><li>Unlike most other nodes, subqueries do not <em>always</em> use the default (<code>in</code>, <code>out</code>, <code>err</code>) ports, this can seem unfamiliar and verbose to Tremor&#x27;s users.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="rationale-and-alternatives"></a>Rationale and alternatives<a class="hash-link" href="#rationale-and-alternatives" title="Direct link to heading">#</a></h2><ul><li>Why is this design the best in the space of possible designs?<ul><li>The syntax is already familiar to Tremor users as it’s similar to the current syntax for Operators and Scripts.</li><li>The flattening of subqueries in the DAG allows for pipeline optimizations to apply to subqueries where applicable.</li></ul></li><li>What other designs have been considered and what is the rationale for not choosing them?<ul><li>A function-like syntax was explored but was abandoned in early stages as it proved to be incongruous for this use case.</li><li>Subqueries could be implemented as Operator nodes inside the DAG but that would make them inscrutable.</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="prior-art"></a>Prior art<a class="hash-link" href="#prior-art" title="Direct link to heading">#</a></h2><ul><li><strong>Modularity RFC</strong><ul><li><a href="https://rfcs.tremor.rs/0010-modularity/" target="_blank" rel="noopener noreferrer">https://rfcs.tremor.rs/0010-modularity/</a></li></ul></li><li><strong>Operators and Scripts in Tremor</strong><ul><li><a href="https://docs.tremor.rs/tremor-query/operators/" target="_blank" rel="noopener noreferrer">https://docs.tremor.rs/tremor-query/operators/</a></li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="unresolved-questions"></a>Unresolved questions<a class="hash-link" href="#unresolved-questions" title="Direct link to heading">#</a></h2><ul><li>None</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="future-possibilities"></a>Future possibilities<a class="hash-link" href="#future-possibilities" title="Direct link to heading">#</a></h2><ul><li>The subquery interface for parameters could be made more robust with introduction of typed parameters.</li><li>It may be useful to add “mandatory parameters” to subqueries. That is, parameters that are <strong>not</strong> given a value during definition and <strong>must</strong> be defined on creation.</li><li>Currently it is possible to both send and receive events on a stream, in the future we could restrict the direction of flow of events for streams inside <code>from</code> and <code>into</code>.</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/rfc/implemented/correlation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Correlation</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/rfc/process/template"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">RFC Template (RFC Title goes here) »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#summary" class="table-of-contents__link">Summary</a></li><li><a href="#motivation" class="table-of-contents__link">Motivation</a></li><li><a href="#guide-level-explanation" class="table-of-contents__link">Guide-level explanation</a><ul><li><a href="#definition" class="table-of-contents__link">Definition</a></li><li><a href="#creation" class="table-of-contents__link">Creation</a></li><li><a href="#use" class="table-of-contents__link">Use</a></li><li><a href="#example-1" class="table-of-contents__link">Example 1</a></li><li><a href="#example-2" class="table-of-contents__link">Example 2</a></li></ul></li><li><a href="#reference-level-explanation" class="table-of-contents__link">Reference-level explanation</a><ul><li><a href="#grammar-changes" class="table-of-contents__link">Grammar Changes</a></li><li><a href="#grammar-additions" class="table-of-contents__link">Grammar Additions</a></li></ul></li><li><a href="#drawbacks" class="table-of-contents__link">Drawbacks</a></li><li><a href="#rationale-and-alternatives" class="table-of-contents__link">Rationale and alternatives</a></li><li><a href="#prior-art" class="table-of-contents__link">Prior art</a></li><li><a href="#unresolved-questions" class="table-of-contents__link">Unresolved questions</a></li><li><a href="#future-possibilities" class="table-of-contents__link">Future possibilities</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/quick-start/">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/community/faqs">FAQs</a></li><li class="footer__item"><a class="footer__link-item" href="/api/0">Tremor API</a></li><li class="footer__item"><a class="footer__link-item" href="/community/governance/CodeofConduct">Code of Conduct</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://chat.tremor.rs/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/TremorDEBS" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/tremor-rs/tremor-runtime/releases" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Download<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.cncf.io/" target="_blank" rel="noreferrer noopener" aria-label="CNCF"><img src="/img/cncf-color.svg" alt="CNCF" style="width: 200px;"></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/favicon.ico" alt="Tremor Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/favicon.ico" alt="Tremor Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></div><div class="footer__copyright">Copyright © 2021 Tremor</div></div></div></footer></div>
<script src="/assets/js/runtime~main.91f82e5b.js"></script>
<script src="/assets/js/main.98e9b71b.js"></script>
</body>
</html>