(self.webpackChunknew_tremor_website=self.webpackChunknew_tremor_website||[]).push([[2399],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return c},kt:function(){return d}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=p(n),d=a,f=m["".concat(l,".").concat(d)]||m[d]||u[d]||i;return n?r.createElement(f,o(o({ref:t},c),{},{components:n})):r.createElement(f,o({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var p=2;p<i;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},1087:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return p},toc:function(){return c},default:function(){return m}});var r=n(2122),a=n(9756),i=(n(7294),n(3905)),o=["components"],s={},l=void 0,p={type:"mdx",permalink:"/tremor-new-website/0003-linked-transports",source:"@site/src/pages/0003-linked-transports.md"},c=[{value:"Summary",id:"summary",children:[]},{value:"Motivation",id:"motivation",children:[]},{value:"Guide-level Explanation",id:"guide-level-explanation",children:[]},{value:"Reference-level Explanation",id:"reference-level-explanation",children:[]},{value:"Drawbacks",id:"drawbacks",children:[]},{value:"Rationale and Alternatives",id:"rationale-and-alternatives",children:[]},{value:"Prior Art",id:"prior-art",children:[]},{value:"Unresolved Questions",id:"unresolved-questions",children:[]},{value:"Future Possibilities",id:"future-possibilities",children:[]}],u={toc:c};function m(e){var t=e.components,n=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Feature Name: rfc_0003_linked_transports"),(0,i.kt)("li",{parentName:"ul"},"Start Date: 2020-01-27"),(0,i.kt)("li",{parentName:"ul"},"Issue: ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/tremor-rs/tremor-rfcs/issues/5"},"tremor-rs/tremor-rfcs#0005")),(0,i.kt)("li",{parentName:"ul"},"RFC PR: ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/tremor-rs/tremor-rfcs/pull/6"},"tremor-rs/tremor-rfcs#0006"))),(0,i.kt)("h2",{id:"summary"},"Summary"),(0,i.kt)("p",null,"The tremor-runtime supports ingress from and egress to external data sources and\nsinks through adapters called ",(0,i.kt)("inlineCode",{parentName:"p"},"Onramps")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"Offramps")," accordingly."),(0,i.kt)("p",null,"There is no mechanism currently that allows the underlying transport encapsulated by ",(0,i.kt)("inlineCode",{parentName:"p"},"Onramps")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"Offramps")," to share their respective underlying connections."),(0,i.kt)("p",null,"This RFC addresses these limitations by introducing ",(0,i.kt)("inlineCode",{parentName:"p"},"linked transports")," notionally and allowing ",(0,i.kt)("inlineCode",{parentName:"p"},"Onramp")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"Offramp")," specifications to reference a common shared underlying transport instance by reference."),(0,i.kt)("h2",{id:"motivation"},"Motivation"),(0,i.kt)("p",null,"The absence of linked transports prohibits authors of tremor-script/tremor-query\nfrom writing proxy applications where request/response style interactions can be\nrouted from a client request back to a client response in the same synchronous blocking RPC transport connection context back to the originating ephemeral client."),(0,i.kt)("p",null,"This limitation also requires having multiple messaging endpoint connections for asynchronous communications when a single connection may be sufficient."),(0,i.kt)("h2",{id:"guide-level-explanation"},"Guide-level Explanation"),(0,i.kt)("p",null,"Given a linked transport configuration:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"transport:\n  - id: rest\n    codec: json\n    config:\n      port: 8080\n      listen:\n          - 0.0.0.0\n      headers:\n        'Content-type': 'application/json'\n      methods:\n        '/api/{id}': [ 'GET', 'POST', 'PUT', 'PATCH', 'DELETE' ]\n")),(0,i.kt)("p",null,"An onramp referencing the transport:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"onramp:\n  - id: rest_inbound\n    ref: rest\n")),(0,i.kt)("p",null,"An offramp referencing the same transport:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"offramp:\n  - id: rest_outbound\n    ref: rest\n")),(0,i.kt)("p",null,"Then, user defined logic in the script or query language can fully proxy or implement services for the underlying transport:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tremor"},'match event of\n  case %{ path == "/api/{id}", method == "GET" } => { "id": "{event.params.id}", "status": 200 },\n  case %{ path == "/api/{id}", method == "POST" } => { "id": "{event.params.id}", "status": 201 },\n  case %{ path == "/api/{id}", method == "PUT" } => { "id": "{event.params.id}", "status": 200 },\n  case %{ path == "/api/{id}", method == "PATCH" } => { "id": "{event.params.id}", "status": 200 },\n  case %{ path == "/api/{id}", method == "DELETE" } => { "id": "{event.params.id}", "status": 204 },\n  default => { "error": "Service unavailable", "status": 503 }\nend\n')),(0,i.kt)("p",null,"The binding specification:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"binding:\n  - id: api_gateway\n    links:\n      '/onramp/rest_inbound/{instance}/out': [ '/pipeline/api/{instance}/in' ]\n      '/pipeline/api/{instance}/out': [ '/offramp/rest_outbound/{instance}/in'  ]\n")),(0,i.kt)("p",null,"There is no facility in the current tremor-runtime to describe transport services that effectively implement or proxy an underlying protocol fully as there is no mechanism to intercept a request, process it through a pipeline, and route the response such that it consummates a single transport level request/response or messaging interaction."),(0,i.kt)("p",null,"A shared transport fills this gap and allows the tremor-runtime to implement API gateways, to act as a HTTP router, proxy, reverse proxy and to implement similar capabilities for other transports."),(0,i.kt)("h2",{id:"reference-level-explanation"},"Reference-level Explanation"),(0,i.kt)("p",null,"None."),(0,i.kt)("h2",{id:"drawbacks"},"Drawbacks"),(0,i.kt)("p",null,"None."),(0,i.kt)("h2",{id:"rationale-and-alternatives"},"Rationale and Alternatives"),(0,i.kt)("p",null,"The introduction of transports coupled with adding optional transport references\nto onramp and offramp specifications enables the tremor-runtime to act as a proxy or reverse proxy endpoint with logic implemented in the scripting or query language."),(0,i.kt)("h2",{id:"prior-art"},"Prior Art"),(0,i.kt)("p",null,"None."),(0,i.kt)("h2",{id:"unresolved-questions"},"Unresolved Questions"),(0,i.kt)("p",null,"This RFC does not specify internals or implementation which is left to the implementor. The motiviating example should be sufficient to drive a suitable implementation."),(0,i.kt)("h2",{id:"future-possibilities"},"Future Possibilities"),(0,i.kt)("p",null,"None known at this time."))}m.isMDXComponent=!0}}]);