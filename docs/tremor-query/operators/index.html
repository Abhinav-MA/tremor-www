<!doctype html>
<html class="docs-version-0.11" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Tremor Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Tremor Blog Atom Feed"><title data-react-helmet="true">Operators | Tremor</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://www.tremor.rs//docs/tremor-query/operators"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="0.11"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-0.11"><meta data-react-helmet="true" property="og:title" content="Operators | Tremor"><meta data-react-helmet="true" name="description" content="Operators are part of the pipeline configuration."><meta data-react-helmet="true" property="og:description" content="Operators are part of the pipeline configuration."><link data-react-helmet="true" rel="shortcut icon" href="/docs/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://www.tremor.rs//docs/tremor-query/operators"><link data-react-helmet="true" rel="alternate" href="https://www.tremor.rs//docs/tremor-query/operators" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://www.tremor.rs//docs/tremor-query/operators" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.374baa17.css">
<link rel="preload" href="/assets/js/runtime~main.6e5aed98.js" as="script">
<link rel="preload" href="/assets/js/main.f3d23fd2.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.tremor.rs/" target="_self" rel="noopener noreferrer" class="navbar__brand"><img src="/img/tremor-logo.svg" alt="Tremor Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/tremor-logo.svg" alt="Tremor Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a class="navbar__item navbar__link" href="/community/getting-started/getting-started">Getting Started</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/community/community">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/community/community">Overview</a></li><li><a href="https://chat.tremor.rs" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Chat<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a class="dropdown__link" href="/community/governance">Governance</a></li><li><a class="dropdown__link" href="/community/faqs">FAQs</a></li><li><a class="dropdown__link" href="/rfc/index">RFCs</a></li></ul></div><a class="navbar__item navbar__link navbar__link--active" href="/docs/index">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/docs/index">0.11</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/tremor-query/operators">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/tremor-query/operators">0.11</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://chat.tremor.rs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discord-link" aria-label="Community Chat"></a><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/index">Tremor</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/overview">Architecture Overview</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/ConstraintsLimitations">Constraints and Limitations</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Recepies</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Operations</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Artefacts</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tremor Script</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Tremor Query</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tremor-query/functions">Aggregate Functions</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">functions</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tremor-query/index">Tremor-Query</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tremor-query/modules">Modules</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/tremor-query/operators">Operators</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tremor-query/pp">pp</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tremor-query/recipes">Periodic Synthetic Metrics Events</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tremor-query/walkthrough">Trickle Walkthough</a></li></ul></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/history">History</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/Glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/api/0">API Explorer</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><span class="theme-doc-version-badge badge badge--secondary">Version: 0.11</span><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Operators</h1></header><p>Operators are part of the pipeline configuration.</p><p>Operators process events and signals in the context of a pipeline. An operator, upon receiving an event from an upstream operator or stream, MAY produce one or many events to one or many downstream directly connected operators. An operator MAY drop events which halts any further processing.</p><p>Operators allow the data processing capabilities of tremor to be extended or specialized without changes to runtime behavior, concurrency, event ordering or other aspects of a running tremor system.</p><p>Operators are created in the context of a pipeline and configured as part of <code>tremor-query</code> <a href="/docs/tremor-query/index#custom-operator-definitions">statements</a>. An operator MUST have an identifier that is unique for its owning pipeline.</p><p>Configuration is of the general form:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><pre tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">define module::operator_name operator my_custom_operator</span></span><span class="token-line" style="color:#393A34"><span class="token plain">with</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  param1 = &quot;foo&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  param2 = [1, 2, 3]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># create - full form</span></span><span class="token-line" style="color:#393A34"><span class="token plain">create operator my_custom_operator_instance from my_custom_operator</span></span><span class="token-line" style="color:#393A34"><span class="token plain">with</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  param1 = &quot;bar&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  param2 = [true, false, {}]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># create - short form</span></span><span class="token-line" style="color:#393A34"><span class="token plain">create operator my_custom_operator;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="script"></a>script<a class="hash-link" href="#script" title="Direct link to heading">#</a></h2><p>An embedded tremor script is created with a special syntax that deviates from the operator creation. For a full reference see the section on <a href="/docs/tremor-query/index#embedded-script-definitions">tremor-query embedded-scripts</a>.</p><p>The tremor script runtime allows to modify events or their metadata. To learn more about Tremor Script please see the <a href="/docs/tremor-script/index">related section</a>.</p><p>The <code>script</code> operator allows to modify the events metadata (via <code>$</code>), and the script local <code>state</code> which persists across single events.</p><p><strong>Outputs</strong>:</p><ul><li><code>out</code> (default output used with <code>emit</code>)</li><li><code>error</code> - channel for runtime errors</li><li><code>&lt;anything else&gt;</code> used when <code>emit event =&gt; &quot;&lt;anything else&gt;&quot;</code></li></ul><p><strong>Examples</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><pre tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain"># definition</span></span><span class="token-line" style="color:#393A34"><span class="token plain">define script rt</span></span><span class="token-line" style="color:#393A34"><span class="token plain">script</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  emit</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><pre tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">define script add</span></span><span class="token-line" style="color:#393A34"><span class="token plain">script</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  emit + 1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">create script add;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from in into add;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from add into out;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="grouperbucket"></a>grouper::bucket<a class="hash-link" href="#grouperbucket" title="Direct link to heading">#</a></h2><p>Bucket will perform a sliding window rate limiting based on event metadata. Limits are applied for every <code>$class</code>. In a <code>$class</code> each <code>$dimensions</code> is allowed to pass <code>$rate</code> messages per second.</p><p>This operator does not support configuration.</p><p>This operator preserves event metadata.</p><p><strong>Metadata Variables</strong>:</p><ul><li><code>$class</code> - The class of an event. (String)</li><li><code>$rate</code> - Allowed events per second per class/dimension (Number)</li><li>(Optional) <code>$dimensions</code> - The dimensions of the event. (Any)</li><li>(Optional)<code>$cardinality</code> - the maximum number of dimensions kept track of at the same time (Number, default: <code>1000</code>)</li></ul><p><strong>Outputs</strong>:</p><ul><li><code>out</code></li><li><code>error</code> - Unprocessable events for example if <code>$class</code> or <code>$rate</code> are not set.</li><li><code>overflow</code> - Events that exceed the rate defined for them</li></ul><p><strong>Example</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><pre tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">define grouper::bucket operator group;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Metrics</strong>:</p><p>The bucket operator generates additional metrics. For each class the following two statistics are generated (as an example):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;measurement&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;bucketing&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;tags&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">&quot;action&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;pass&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">&quot;class&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;test&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">&quot;direction&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;output&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">&quot;node&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;bucketing&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">&quot;pipeline&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;main&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">&quot;port&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;out&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;fields&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;count&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">93</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;timestamp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1553012903452340000</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;measurement&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;bucketing&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;tags&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">&quot;action&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;overflow&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">&quot;class&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;test&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">&quot;direction&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;output&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">&quot;node&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;bucketing&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">&quot;pipeline&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;main&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">&quot;port&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;out&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;fields&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;count&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">127</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;timestamp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1553012903452340000</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This tells us the following, up until this measurement was published in the class <code>test</code>:</p><ul><li>(<code>pass</code>) Passed 93 events</li><li>(<code>overflow</code>) Marked 127 events as overflow due to not fitting in the limit</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="genericbackpressure"></a>generic::backpressure<a class="hash-link" href="#genericbackpressure" title="Direct link to heading">#</a></h2><p>This operator is deprecated please use <code>qos::backpressure</code> instead.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="qosbackpressure"></a>qos::backpressure<a class="hash-link" href="#qosbackpressure" title="Direct link to heading">#</a></h2><p>The backpressure operator is used to introduce delays based on downstream systems load. Longer backpressure steps are introduced every time the latency of a downstream system reached <code>timeout</code>, or an error occurs. On a successful transmission within the timeout limit, the delay is reset.</p><p>The operator supports two modes:</p><ul><li><code>discard</code> - the standard, when backpressure is triggered it will discard new messages by sending them to the <code>overflow</code> output port. This is designed to fulfill the need of low transport latency at the cost of loss.</li><li><code>pause</code> - it will trigger a circuit breaker and ask the sources that send it data to stop sending additional events. No Event is discarded by the backpressure operator. This is designed to deal with situations where losing events is not an option - but the garuantee of losslessness depends on the source and how it can handle circuit breaker events.</li></ul><p>This operator preserves event metadata.</p><p><strong>Configuration options</strong>:</p><ul><li><code>timeout</code> - Maximum allowed &#x27;write&#x27; time in milliseconds.</li><li><code>steps</code> - Array of values to delay when a we detect backpressure. (default: <code>[50, 100, 250, 500, 1000, 5000, 10000]</code>)</li><li><code>method</code> - Either <code>discard</code> or <code>pause</code> to define how backpressure is handled (default: <code>discard</code>)</li></ul><p><strong>Outputs</strong>:</p><ul><li><code>out</code></li><li><code>overflow</code> - Events that are not let past due to active backpressure</li></ul><p><strong>Example</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><pre tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">define qos::backpressure operator bp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">with</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  timeout = 100,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  method = &quot;discard&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="qospercentile"></a>qos::percentile<a class="hash-link" href="#qospercentile" title="Direct link to heading">#</a></h2><p>An alternative traffic shaping option to backpressure. Instead of all dropping events for a given
time we drop a statistical subset with an increasing percentage of events dropped the longer we
see errors / timeouts.</p><p>In general <code>step_up</code> should always be significantly smaller then <code>step_down</code> to ensure we gradually
reapproach the ideal state.</p><p>This operator preserves event metadata.</p><p><strong>Configuration options</strong>:</p><ul><li><code>timeout</code> - Maximum allowed &#x27;write&#x27; time in milliseconds.</li><li><code>step_down</code> - What additional percentile should be dropped in the case of a timeout (default 5%: <code>0.05</code>)</li><li><code>step_up</code> - What percentile should be recovered in case of a good event. (default: 0.1%: <code>0.001</code>)</li></ul><p><strong>Outputs</strong>:</p><ul><li><code>out</code></li><li><code>overflow</code> - Events that are not let past due to active backpressure</li></ul><p><strong>Example</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><pre tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">define qos::percentile operator as perc</span></span><span class="token-line" style="color:#393A34"><span class="token plain">with</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  timeout = 100,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  step_down = 0.1 # 10%</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="qosroundrobin"></a>qos::roundrobin<a class="hash-link" href="#qosroundrobin" title="Direct link to heading">#</a></h2><p>Evenly distributes events over it&#x27;s outputs. If a CB trigger event is received from an output this
output is skipped until the circuit breaker is restored. If all outputs are triggered the operator
itself triggers a CB event.</p><p>This operator preserves event metadata.</p><p><strong>Outputs</strong>:</p><ul><li><code>*</code> (any named output is possible)</li></ul><p><strong>Example</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><pre tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">define qos::roundrobin operator roundrobin</span></span><span class="token-line" style="color:#393A34"><span class="token plain">with</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  outputs = [&quot;round&quot;, &quot;robin&quot;, &quot;outputs&quot;]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="qoswal"></a>qos::wal<a class="hash-link" href="#qoswal" title="Direct link to heading">#</a></h2><p>A Write Ahead Log that will persist data to disk and feed the following operators from this disk
cache. It allows to run onramps that do not provide any support for delivery guarantees with
offramps that do.</p><p>The wal operator will intercept and generate it&#x27;s own circuit breaker events. You can think about it
as a firewall that will protect all operators before itself from issues beyond it. On the other hand
it will indiscriminately consume data from sources and operators before itself until it&#x27;s own
circuit breaking conditions are met.</p><p>At the same time will it interact with tremors guaranteed delivery system, events are only removed
from disk once they&#x27;re acknowledged. In case of delivery failure the WAL operator will replay the
failed events. On the same way the WAL operator will acknowledge events that it persists to disk.</p><p>The WAL operator should be used with caution, since every event that passes through it will be
written to the hard drive it has a significant performance impact.</p><p>This operator preserves event metadata.</p><p><strong>Configuration options</strong>:</p><ul><li><code>read_count</code> - Maximum number of events that are read form the WAL at one time.</li><li><code>dir</code> - Directory to store the WAL-file in (optional, if omitted the WAL will remain in memory and not be
persisted to disk)</li><li><code>max_elements</code> - Maximum number of elements the WAL will cache before triggering a CB event</li><li><code>max_bytes</code> - Maximum space on disk the WAL should take (this is a soft limit!)</li></ul><p>Only one of <code>max_elements</code> or <code>max_bytes</code> is required, setting both is possible.</p><p><strong>Outputs</strong>:</p><ul><li><code>out</code></li></ul><p><strong>Example</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><pre tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">define qos::wal operator wal with</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  dir = &quot;./wal&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  read_count = 20,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  max_elements = 1000,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  max_bytes = 10485760</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="genericbatch"></a>generic::batch<a class="hash-link" href="#genericbatch" title="Direct link to heading">#</a></h2><p>The batch operator is used to batch multiple events and send them in a bulk fashion. It also allows to set a timeout of how long the operator should wait for a batch to be filled.</p><p>This operator batches both the event payload and event metadata into a single bulk event. Downstream pipeline nodes or offramps will receive 1 such bulk event but will treat its context as multiple events and might act different e.g. when it comes to building a request payload in the offramp context or other use cases. Empty bulk events are usually considered as <code>no</code> event.</p><p>Supported configuration options are:</p><ul><li><code>count</code> - Elements per batch</li><li><code>timeout</code> - Maximum delay between the first element of a batch and the last element of a batch.</li></ul><p><strong>Outputs</strong>:</p><ul><li><code>out</code></li></ul><p><strong>Example</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><pre tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">define generic::batch operator batch with</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  count = 300</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="genericcounter"></a>generic::counter<a class="hash-link" href="#genericcounter" title="Direct link to heading">#</a></h2><p>Keeps track of the number of events as they come and emits the current count out alongside the event. The output is a record of the form <code>{&quot;count&quot;: n, &quot;event&quot;: event}</code>, where <code>n</code> is the current count and <code>event</code> is the original event.</p><p>The counter starts when the first event comes through and begins from 1.</p><p>This operator preserves event metadata.</p><p><strong>Outputs</strong>:</p><ul><li><code>out</code></li></ul><p><strong>Example</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><pre tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">define generic::counter operator counter;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="debughistory"></a>debug::history<a class="hash-link" href="#debughistory" title="Direct link to heading">#</a></h2><p>!!! note</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">This operator is for debugging purposes only, and should not be used in production deployments.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This operator generates a history entry in the event metadata underneath the field provided in the <code>name</code> config value. Data is pushed to the array as a Striong in the form: <code>&quot;event: &lt;op&gt;(&lt;event_id&gt;)&quot;</code>.</p><p>This can be used as a tracepoint of events in a complex pipeline setup.</p><p>This operator manipulates a section of the event metadata.</p><p><strong>Configuration options</strong>:</p><ul><li><code>op</code> - The operation name of this operator</li><li><code>name</code> - The field to store the history on</li></ul><p><strong>Outputs</strong>:</p><ul><li><code>out</code></li></ul><p><strong>Example</strong>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><pre tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">define debug::history operator history with</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  op = &quot;my-checkpoint&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  name = &quot;event_history&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/tremor-rs/tremor-www/tree/main/versioned_docs/version-0.11/tremor-query/operators.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/tremor-query/modules"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Modules</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/tremor-query/pp"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">pp Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#script" class="table-of-contents__link">script</a></li><li><a href="#grouperbucket" class="table-of-contents__link">grouper::bucket</a></li><li><a href="#genericbackpressure" class="table-of-contents__link">generic::backpressure</a></li><li><a href="#qosbackpressure" class="table-of-contents__link">qos::backpressure</a></li><li><a href="#qospercentile" class="table-of-contents__link">qos::percentile</a></li><li><a href="#qosroundrobin" class="table-of-contents__link">qos::roundrobin</a></li><li><a href="#qoswal" class="table-of-contents__link">qos::wal</a></li><li><a href="#genericbatch" class="table-of-contents__link">generic::batch</a></li><li><a href="#genericcounter" class="table-of-contents__link">generic::counter</a></li><li><a href="#debughistory" class="table-of-contents__link">debug::history</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/quick-start/">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/faqs/">FAQs</a></li><li class="footer__item"><a class="footer__link-item" href="/api/0">Tremor API</a></li><li class="footer__item"><a class="footer__link-item" href="/community/governance/CodeofConduct">Code of Conduct</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://chat.tremor.rs/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/TremorDEBS" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/tremor-rs/tremor-runtime/releases" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Download<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.cncf.io/" target="_blank" rel="noreferrer noopener" aria-label="CNCF"><img src="/img/cncf-color.svg" alt="CNCF" style="width: 200px;"></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/favicon.ico" alt="Tremor Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/favicon.ico" alt="Tremor Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></div><div class="footer__copyright">Copyright Â© 2021 Tremor</div></div></div></footer></div>
<script src="/assets/js/runtime~main.6e5aed98.js"></script>
<script src="/assets/js/main.f3d23fd2.js"></script>
</body>
</html>