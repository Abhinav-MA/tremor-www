<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.ff31de0ff">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Tremor Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Tremor Blog Atom Feed"><title data-react-helmet="true">CNCF OpenTelemetry Zipkin Interorking | Tremor</title><meta data-react-helmet="true" property="og:url" content="https://www.tremor.rs//docs/recipes/otel_zipkin/README"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="0.11"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-0.11"><meta data-react-helmet="true" property="og:title" content="CNCF OpenTelemetry Zipkin Interorking | Tremor"><meta data-react-helmet="true" name="description" content="This example builds on the passthrough CNCF OpenTelemetry"><meta data-react-helmet="true" property="og:description" content="This example builds on the passthrough CNCF OpenTelemetry"><link data-react-helmet="true" rel="shortcut icon" href="/docs/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://www.tremor.rs//docs/recipes/otel_zipkin/README"><link data-react-helmet="true" rel="alternate" href="https://www.tremor.rs//docs/recipes/otel_zipkin/README" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://www.tremor.rs//docs/recipes/otel_zipkin/README" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.772104c2.css">
<link rel="preload" href="/assets/js/runtime~main.c2c4df80.js" as="script">
<link rel="preload" href="/assets/js/main.d838971a.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.tremor.rs/" target="_self" rel="noopener noreferrer" class="navbar__brand"><img src="/img/tremor-logo.png" alt="Tremor Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/tremor-logo.png" alt="Tremor Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a class="navbar__item navbar__link" href="/getting-started/about/">About Us</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/index">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/quick-start">Usage Guide</a><a class="navbar__item navbar__link" href="/api/0">API</a><a class="navbar__item navbar__link" href="/rfc/index">RFCs</a><a class="navbar__item navbar__link" href="/community/community">Community</a><a class="navbar__item navbar__link" href="/community/governance">Governance</a><a class="navbar__item navbar__link" href="/faqs">FAQs</a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link" href="/docs/index">0.11</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/recipes/otel_zipkin/README">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/recipes/otel_zipkin/README">0.11</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub">GitHub</a><div class="searchWrapper_3rmH"><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div></div><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a href="https://www.tremor.rs/" target="_self" rel="noopener noreferrer" class="navbar__brand"><img src="/img/tremor-logo.png" alt="Tremor Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/tremor-logo.png" alt="Tremor Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/getting-started/about/">About Us</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/index">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/quick-start">Usage Guide</a></li><li class="menu__list-item"><a class="menu__link" href="/api/0">API</a></li><li class="menu__list-item"><a class="menu__link" href="/rfc/index">RFCs</a></li><li class="menu__list-item"><a class="menu__link" href="/community/community">Community</a></li><li class="menu__list-item"><a class="menu__link" href="/community/governance">Governance</a></li><li class="menu__list-item"><a class="menu__link" href="/faqs">FAQs</a></li><li class="menu__list-item"><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub">GitHub</a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/next/recipes/otel_zipkin/README">Next</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/recipes/otel_zipkin/README">0.11</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/index">Tremor</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/overview">Architecture Overview</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ConstraintsLimitations">Constraints and Limitations</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Recepies</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">passthrough</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/passthrough/README">Passthrough</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">filter</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/filter/README">Filter</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">transform</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/transform/README">Transform</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">validate</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/validate/README">Transform</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">logstash</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/logstash/README">Transform</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">influx</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/influx/README">Transform</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">postgres_timescaledb</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/postgres_timescaledb/README">Transform</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">grafana</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/grafana/README">Transform</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">syslog_udp</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/syslog_udp/README">syslog udp</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">syslog_udp_dns</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/syslog_udp_dns/README">syslog udp dns</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">transient_gd</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/transient_gd/README">Transient Write-Ahead Log</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">persistent_gd</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/persistent_gd/README">Persistent Write-Ahead Log</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">roundrobin</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/roundrobin/README">Round Robin</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">kafka_gd</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/kafka_gd/README">Kafka delivery guarantees</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">servers_lt_http</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/servers_lt_http/README">HTTP Server</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">servers_lt_ws</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/servers_lt_ws/README">Websocket Server</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">proxies_lt_http</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/proxies_lt_http/README">HTTP Proxy</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">proxies_lt_ws</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/proxies_lt_ws/README">Websocket Proxy</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">bridges_lt_http_ws</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/bridges_lt_http_ws/README">HTTP -&gt; Websocket Bridge</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">reverse_proxy_load_balancing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/reverse_proxy_load_balancing/README">Reverse proxy with Load Balancing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">quota_service</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/quota_service/README">Quota Service</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">configurator</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/configurator/README">Configurator</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">polling_alerts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/polling_alerts/README">Polling</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">kafka_elastic_correlation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/kafka_elastic_correlation/README">Ingesting documents from kafka into elastic</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">otel_passthrough</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/otel_passthrough/README">CNCF OpenTelemetry Passthrough</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">otel_zipkin</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/recipes/otel_zipkin/README">CNCF OpenTelemetry Zipkin Interorking</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">otel_jaeger</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/otel_jaeger/README">CNCF OpenTelemetry Jaeger Interworking</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">otel_prometheus</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/otel_prometheus/README">CNCF OpenTelemetry Prometheus Interworking</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">otel_elastic_apm</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/otel_elastic_apm/README">CNCF OpenTelemetry Elastic APM Interworking</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/recipes/README">Tremor Workshop</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Operations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/operations/cli">Tremor cli v0.11</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/operations/configuration-walkthrough">Configuration Walkthrough</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/operations/configuration">Configuring Tremor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/operations/gdcb">Circuit Breakers and Guaranteed Delivery</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/operations/linked-transports">Linked Transports</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/operations/monitoring">Monitoring</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Artefacts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/artefacts/codecs">Codecs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/artefacts/offramps">Offramps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/artefacts/onramps">Onramps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/artefacts/postprocessors">Postprocessors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/artefacts/preprocessors">Preprocessors</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tremor Script</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/extractors">Extractors</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">extractors</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/extractors/base64">Base64</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/extractors/cidr">CIDR</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/extractors/datetime">Datetime</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/extractors/dissect">Dissect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/extractors/glob">Glob</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/extractors/grok">Grok</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/extractors/influx">Influx</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/extractors/json">JSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/extractors/kv">KV</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/extractors/regex">Regex (re)</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/functions">Functions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/index">Tremor-Script</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/modules">Modules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/pp">pp</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/recipes">Recipes</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">stdlib</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/cncf">cncf</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">cncf</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/cncf/otel">otel</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">otel</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/cncf/otel/logs">logs</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">logs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/cncf/otel/logs/severity">severity</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/cncf/otel/logs/traceflags">traceflags</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/cncf/otel/metrics">metrics</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">metrics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/cncf/otel/metrics/temporality">temporality</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/cncf/otel/span_id">span_id</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/cncf/otel/trace">trace</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">trace</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/cncf/otel/trace/spankind">spankind</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/cncf/otel/trace/status">status</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/cncf/otel/trace_id">trace_id</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/std">std</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">std</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/std/array">array</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/std/base64">base64</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/std/binary">binary</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/std/float">float</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/std/integer">integer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/std/json">json</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/std/math">math</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/std/random">random</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/std/range">range</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/std/re">re</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/std/record">record</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/std/string">string</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/std/test">test</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/std/type">type</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/std/url">url</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/tremor">tremor</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">tremor</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/tremor/chash">chash</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/tremor/origin">origin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-script/stdlib/tremor/system">system</a></li></ul></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tremor Query</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-query/functions">Aggregate Functions</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">functions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-query/functions/stats">The `stats` namespace</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-query/functions/win">The `win` namespace</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-query/index">Tremor-Query</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-query/modules">Modules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-query/operators">Operators</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-query/pp">pp</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-query/recipes">Periodic Synthetic Metrics Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tremor-query/walkthrough">Trickle Walkthough</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/history">History</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Glossary">Glossary of Terms</a></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div><span class="badge badge--secondary">Version: 0.11</span></div><header><h1 class="docTitle_3a4h">CNCF OpenTelemetry Zipkin Interorking</h1></header><div class="markdown"><p>This example builds on the passthrough CNCF OpenTelemetry
configuration but configures Zipkin as a receiver and exporter in the
OpenTelemetry Collector.</p><p>It shows how legacy observability frameworks such as Zipkin can be
ingested into OpenTelemetry based services directly, or via the
OpenTelemetry collector into tremor for specialized processing.</p><ul><li>Zipkin service</li><li>CNCF OpenTelemetry Collector service</li><li>CNCF OpenTelemetry Onramp deployed into tremor</li><li>Deployment configuration file</li></ul><p>External open telemetry clients can use port <code>4316</code> to send OpenTelemetry logs, traces and metrics
through tremor. Tremor prints the json mapping to standard out and forwards the events to the
OpenTelemetry collector.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="environment"></a>Environment<a class="hash-link" href="#environment" title="Direct link to heading">#</a></h2><p>The <a target="_blank" href="/assets/files/00_ramps-55074d511b0774f2dc006b776f21f8c9.yaml">onramp</a> we use is the <code>otel</code> CNCF OpenTelemetry onramp listening on a non-standard CNCF OpenTelemetry port <code>4316</code>, it receives protocol buffer messages over gRPC on this port. The log, metric and trace events received are converted to tremor&#x27;s value system and passed through a passthrough pipeline to the CNCF OpenTelemetry sink. The sink will try to connect to a downstream CNCF
OpenTelemetry endpoint. In this workshop we will use the well known OpenTelemetry port of <code>4317</code> for our sink and run the standard OpenTelemetry collector on this port using its a <a target="_blank" href="/assets/files/collector-716836fddef3036f82c3973ed80c3cda.yaml">collector configuration</a>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">onramp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otlp</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel </span><span class="token comment" style="color:#999988;font-style:italic"># Use the OpenTelemetry gRPC listener source</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">codec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> json </span><span class="token comment" style="color:#999988;font-style:italic"># Json is the only supported value</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4316</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># The TCP port to listen on</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">host</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0.0.0.0&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># The IP address to bind on ( all interfaces in this case )</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>It connects to a passthrough pipeline. This pipeline forwards any received
observability events downstream unchanged.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><div tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">select event from in into out;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>We connect the passthrough output events into a standard output sink.
The <a target="_blank" href="/assets/files/01_binding-f47d5ccaad9a4f1dcd46ce7f49351c46.yaml">binding</a> expresses these relations and gives deployment connectivity graph.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">binding</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> example</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">links</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">&#x27;/onramp/otlp/{instance}/out&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/pipeline/example/{instance}/in&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">&#x27;/pipeline/example/{instance}/out&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/offramp/stdout/{instance}/in&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Finally the <a target="_blank" href="/assets/files/02_mapping-9c81a0870131ab67e86b0f001460a101.yaml">mapping</a> instanciates the binding with the given name and instance variable to activate the elements of the binding.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">mapping</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">/binding/example/passthrough</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">instance</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;passthrough&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="business-logic"></a>Business Logic<a class="hash-link" href="#business-logic" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><div tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">select event from in into out</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="command-line-testing-during-logic-development"></a>Command line testing during logic development<a class="hash-link" href="#command-line-testing-during-logic-development" title="Direct link to heading">#</a></h2><p>Use any compliant OpenTelemetry instrumented application and configure the
server to our source on port <code>4316</code> instead of the default <code>4317</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="docker"></a>Docker<a class="hash-link" href="#docker" title="Direct link to heading">#</a></h2><p>For convenience, use the provided <a target="_blank" href="/assets/files/docker-compose-465377b0d6c13f257ef5397ce8051ec0.yaml">docker-compose.yaml</a> to
start and stop tremor and the opentelemetry collector as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Start</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">$ docker compose up</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Stop</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">$ docker compose down</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="zipkin-client"></a>Zipkin client<a class="hash-link" href="#zipkin-client" title="Direct link to heading">#</a></h2><p>We use an existing Zipkin client for demonstration purposes. Fetch the standard zipkin php
client as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Clone the git repo</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/openzipkin/zipkin-php-example</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Cd into the repo root</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">cd</span><span class="token plain"> zipkin-php-example</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Install dependent php libraries</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">composer</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>And, assuming you have PHP composer, run the front and backend in two separate terminal windows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Spin up the PHP backend on `locahost:9000`</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">composer</span><span class="token plain"> -run run-frontend</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Spin up the PHP frontend on `localhost:8081`</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">composer</span><span class="token plain"> -run run-backend</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Hit the frontend via curl ( in another terminal )</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Generate trace spand via curl</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -o - http://locahost:8081/</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Verify that our frontend has issued some spans in its terminal output</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Output from our frontend composer terminal</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> php -S </span><span class="token string" style="color:#e3116c">&#x27;localhost:8081&#x27;</span><span class="token plain"> frontend.php</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Tue Apr  </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:53:56 </span><span class="token number" style="color:#36acaa">2021</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> PHP </span><span class="token number" style="color:#36acaa">7.4</span><span class="token plain">.10 Development Server </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">http://localhost:8081</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> started</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Tue Apr  </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:54:03 </span><span class="token number" style="color:#36acaa">2021</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">::1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:50812 Accepted</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Tue Apr  </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:54:03 </span><span class="token number" style="color:#36acaa">2021</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">::1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:50812 Closing</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Verify that our PHP backend has issued some spans in its terminal output</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Output from our backend composer terminal</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> php -S </span><span class="token string" style="color:#e3116c">&#x27;localhost:9000&#x27;</span><span class="token plain"> backend.php</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Tue Apr  </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:50:34 </span><span class="token number" style="color:#36acaa">2021</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> PHP </span><span class="token number" style="color:#36acaa">7.4</span><span class="token plain">.10 Development Server </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">http://localhost:9000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> started</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Tue Apr  </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:54:03 </span><span class="token number" style="color:#36acaa">2021</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">::1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:50813 Accepted</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Tue Apr  </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:54:03 </span><span class="token number" style="color:#36acaa">2021</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">::1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:50813 Closing</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Verify our spans reached the Zipkin UI deployed in docker via pointing our browser to <code>http://localhost:9412</code> by searching for traces:</p><p><img alt="screenshot.png" src="/assets/images/zipkin-ui-05a2c533ec3e588002334f955e1ebb93.png"></p><p>Note that we expose the Zipkin UI on a non-standard port via docker so that our Zipkin traffic actually gets routed via the <code>opentelemetry collector</code> to <code>tremor</code> and to the Zipkin service and ui. In this way the <code>opentelemetry collector</code> and <code>tremor</code>.</p><p>From the perspective of the Zipkin PHP client - this is a plain vanilla Zipkin service.
In practice, this is the <code>opentelemetry-collector</code> which is forwarding to both tremor and to the zipkin-ui in this demo.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="advanced"></a>Advanced<a class="hash-link" href="#advanced" title="Direct link to heading">#</a></h2><p>Rather than run multiple sidecars, tremor could be configured to transform Zipkin
traffic directly to the OpenTelemetry format. Given transformation logic as follows</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly tremor"><div tabindex="0" class="prism-code language-tremor codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">### Transform zipkin b3 ( http/json ) to otel</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">use cncf::otel;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">use tremor::system;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">use std::record;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">fn transform_span(span) with</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  # A transient event counter</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  let count = match state of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    case null =&gt; let state = 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    default =&gt; let state = state + 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  end;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  match span of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    case %{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      present id,           # span id</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      # present parentId,   # span parent id</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      present traceId,      # trace id</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      present annotations,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      present name,         # name</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      #present kind,        # CLIENT</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      # present remoteEndpoint,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      present timestamp,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      present tags,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      present duration,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      present localEndpoint,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    } =&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          &quot;resource&quot;: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &quot;attributes&quot;: merge span.tags of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">               { &quot;tremor.ingest_ns&quot;: system::ingest_ns() }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">             end,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &quot;dropped_attributes_count&quot;: 0,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          &quot;instrumentation_library_spans&quot;: [</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &quot;instrumentation_library&quot;: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &quot;name&quot;: &quot;tremor&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &quot;version&quot;: system::version(),</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &quot;spans&quot;: [</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  &quot;start_time_unix_nano&quot;: (span.timestamp * 1000),</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  &quot;end_time_unix_nano&quot;: (span.timestamp * 1000) + (span.duration * 1000),</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  &quot;name&quot;: &quot;#{span.name} - #{count}&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  &quot;attributes&quot;: record::from_array(for span.annotations of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    case(i,e) =&gt; [ &quot;zipkin.annotation.#{e.value}&quot;, e.timestamp * 1000  ] # convert ts micros -&gt; nanos</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  end),</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  &quot;dropped_attributes_count&quot;: 0,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  &quot;kind&quot;: match span of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                     case %{ present kind } =&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                       match span.kind of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        case &quot;CLIENT&quot; =&gt; otel::trace::spankind::client</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        case &quot;SERVER&quot; =&gt; otel::trace::spankind::server</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        case &quot;PRODUCER&quot; =&gt; otel::trace::spankind::server</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        case &quot;CONSUMER&quot; =&gt; otel::trace::spankind::server</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        default =&gt; otel::trace::spankind::client</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                      end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                     default =&gt; otel::trace::spankind::client</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  end,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  &quot;trace_state&quot;: &quot;&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  &quot;parent_span_id&quot;: match span of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    case %{ present parentId, } =&gt; span.parentId</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    default =&gt; &quot;&quot; # no parent span</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  end,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  &quot;span_id&quot;: span.id,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  &quot;trace_id&quot;: span.traceId,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  &quot;status&quot;: otel::trace::status::ok(),</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  &quot;events&quot;: [],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  &quot;links&quot;: [],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  &quot;dropped_events_count&quot;: 0,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  &quot;dropped_links_count&quot;: 0,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              ]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          ]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    default =&gt; { &quot;drop&quot;: span }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>And a tremor query as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><div tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">#</span></div><div class="token-line" style="color:#393A34"><span class="token plain"># Process zipkin b3 [span] to [otel resource span]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">#</span></div><div class="token-line" style="color:#393A34"><span class="token plain">define script to_zipkin</span></div><div class="token-line" style="color:#393A34"><span class="token plain">script</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  use zipkin_to_otel;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  for event.trace of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    case (i,span) =&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      merge zipkin_to_otel::transform_span(span) of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          &quot;resource&quot;: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &quot;attributes&quot;: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &quot;http.url.path&quot;: event.request.url.path,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &quot;http.url.host&quot;: event.request.url.host,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &quot;http.url.port&quot;: event.request.url.port,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &quot;http.url.scheme&quot;: event.request.url.scheme,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &quot;http.headers.user-agent&quot;: event.request.headers.user-agent[0],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &quot;http.headers.b3&quot;: event.request.headers.b3[0],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &quot;http.method&quot;: event.request.method,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">create script to_zipkin;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"># Push zipkin-b3/http [trace] into transformer capturing http request metadata</span></div><div class="token-line" style="color:#393A34"><span class="token plain">select { &quot;request&quot;: $request, &quot;trace&quot;: event } from in into to_zipkin;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"># Wrap resource spans as a trace event compatible with tremor otel sink</span></div><div class="token-line" style="color:#393A34"><span class="token plain">select { &quot;trace&quot;: event } from to_zipkin into out;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Removing the <code>zipkin-all-in-one</code> container from this walkthrough&#x27;s <code>docker-compose.yaml</code> and removing the <code>OpenTelemetry collector</code> configuration and container should be sufficient to produce a basic working environment based solely on tremor, and the
Zipkin PHP clients with minor adjustments to the script and query files above.</p><p>However, the CNCF OpenTelemetry Collector has excellent support for legacy observability
frameworks and formats. Tremor does not. The Zipkin UI will be familiar to users who
have experience of observability through the Zipkin project. Tremor does not have a UI at all. We provide the example to illustrate a more complete example of how tremor is typically configured in production environments and to illustrate how existing trace and span information can be adapted to <code>CNCF OpenTelemetry</code> using tremor&#x27;s scripting and query language support.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/tremor-rs/tremor-new-website/tree/main/versioned_docs/version-0.11/recipes/41_otel_zipkin/README.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/recipes/otel_passthrough/README"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« CNCF OpenTelemetry Passthrough</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/recipes/otel_jaeger/README"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">CNCF OpenTelemetry Jaeger Interworking Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#environment" class="table-of-contents__link">Environment</a></li><li><a href="#business-logic" class="table-of-contents__link">Business Logic</a></li><li><a href="#command-line-testing-during-logic-development" class="table-of-contents__link">Command line testing during logic development</a></li><li><a href="#docker" class="table-of-contents__link">Docker</a></li><li><a href="#zipkin-client" class="table-of-contents__link">Zipkin client</a></li><li><a href="#advanced" class="table-of-contents__link">Advanced</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/quick-start/">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/faqs/">FAQs</a></li><li class="footer__item"><a class="footer__link-item" href="/api/0">Tremor API</a></li><li class="footer__item"><a class="footer__link-item" href="/community/governance/CodeofConduct">Code of Conduct</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://chat.tremor.rs/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/TremorDEBS" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://github.com/tremor-rs/tremor-runtime/releases" target="_blank" rel="noopener noreferrer" class="footer__link-item">Download</a></li><li class="footer__item"><a href="https://www.cncf.io/" target="_blank" rel="noreferrer noopener" aria-label="CNCF"><img src="cncf-color.svg" alt="CNCF"></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/favicon.ico" alt="Tremor Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/favicon.ico" alt="Tremor Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></div><div class="footer__copyright">Copyright Â© 2021 Tremor</div></div></div></footer></div>
<script src="/assets/js/runtime~main.c2c4df80.js"></script>
<script src="/assets/js/main.d838971a.js"></script>
</body>
</html>