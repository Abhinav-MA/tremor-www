<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Tremor Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Tremor Blog Atom Feed"><title data-react-helmet="true">Walkthough | Tremor</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://www.tremor.rs//docs/next/scripting/tremor-query/walkthrough"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Walkthough | Tremor"><meta data-react-helmet="true" name="description" content="In this section we walk through increasingly complex tremor query language ( trickle )"><meta data-react-helmet="true" property="og:description" content="In this section we walk through increasingly complex tremor query language ( trickle )"><link data-react-helmet="true" rel="shortcut icon" href="/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://www.tremor.rs//docs/next/scripting/tremor-query/walkthrough"><link data-react-helmet="true" rel="alternate" href="https://www.tremor.rs//docs/next/scripting/tremor-query/walkthrough" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://www.tremor.rs//docs/next/scripting/tremor-query/walkthrough" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.374baa17.css">
<link rel="preload" href="/assets/js/runtime~main.7fca1092.js" as="script">
<link rel="preload" href="/assets/js/main.34faea97.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.tremor.rs/" target="_self" rel="noopener noreferrer" class="navbar__brand"><img src="/img/tremor-logo.svg" alt="Tremor Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/tremor-logo.svg" alt="Tremor Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a class="navbar__item navbar__link" href="/community/getting-started/getting-started">Getting Started</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/community/community">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/community/community">Overview</a></li><li><a href="https://chat.tremor.rs" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Chat<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a class="dropdown__link" href="/community/governance">Governance</a></li><li><a class="dropdown__link" href="/community/faqs">FAQs</a></li><li><a class="dropdown__link" href="/rfc/index">RFCs</a></li><li><a class="dropdown__link" href="/community/EventsAndMedia">Events and Media</a></li></ul></div><a class="navbar__item navbar__link navbar__link--active" href="/docs/next/index">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/docs/next/index">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/next/scripting/tremor-query/walkthrough">Next</a></li><li><a class="dropdown__link" href="/docs/index">0.11</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://chat.tremor.rs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discord-link" aria-label="Community Chat"></a><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/next/index">Tremor</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/next/overview">Architecture Overview</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/next/ConstraintsLimitations">Constraints and Limitations</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Recipes</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Operations</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Artefacts</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Scripting</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/scripting/modules">Modules</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/scripting/ pp">Lexical Preprocessor</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Tremor Query</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/scripting/tremor-query/index">Tremor-Query</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/next/scripting/tremor-query/walkthrough">Walkthough</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/scripting/tremor-query/operators">Operators</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/scripting/tremor-query/functions">Aggregate Functions</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/scripting/tremor-query/recipes">Recipes</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">functions</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Tremor Script</a></li></ul></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/next/history">History</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/next/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/api/0">API Explorer</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for Tremor <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/index">latest version</a></b> (0.11).</div></div><div class="docItemContainer_33ec"><article><span class="theme-doc-version-badge badge badge--secondary">Version: Next</span><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Walkthough</h1></header><p>In this section we walk through increasingly complex tremor query language ( trickle )
programming examples, introducing key concepts as we progress.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><p>Trickle is a near real-time stream-based structured query language that
builds on the tremor scripting language.</p><p>Trickle queries are compiled in pipeline DAGs and replace the yaml pipeline
format used in previous versions to describe event processing graphs in
the tremor runtime.</p><p>The most basic query possible in trickle is</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><pre tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">select event from in into out; # A basic passthrough query pipeline</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The <code>event</code> keyword selects the event from the standard input stream <code>in</code>
and passes it through unchanged to the standard output stream <code>out</code>.</p><p>In tremor&#x27;s trickle query language queries are compiled and optimised and
data is streamed though the query. Data can be passed through, transformed,
filtered, aggregated, branched or combined to form continuous stream processing
algorithms.</p><p>Like other event processing languages, trickle <em>inverts</em> the relationship between
query and data when compared to normal RDBMS SQL languages. Instead of running a
dynamic query against static in memory or disk persisted data, we compile and
optimise queries and stream near real-time data through each query.</p><p>Data can be ingested from the outside world via the &#x27;in&#x27; standard stream.
Data can be produced to the outside world via the &#x27;out&#x27; standard stream.
Errors can be processed through the &#x27;err&#x27; standard stream.</p><p>These three primitives are analogous to the <code>stdin</code>, <code>stdout</code> and <code>stderr</code> streams
in UNIX-like systems. These can be chained or interconnected via connecting multiple
statements together to form a directed acyclic graph.</p><p>We can branch inputs using <code>where</code> and <code>having</code> clauses as filters to logically
partition streams into independent processing streams.</p><p>In the below example we partition events by their <code>seq_num</code> field. If the number
is even, we branch the corresponding events into a stream named <code>evens</code>. If the
number is odd, we branch to a stream named <code>odds</code>.</p><p>The logical inverse of branching is to unify or union streams together, this operation
is also supported via the select operation and is demonstrated below. We combine
the <code>evens</code> and <code>odds</code> streams into the standard output stream</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><pre tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain"># create private intermediate internal streams</span></span><span class="token-line" style="color:#393A34"><span class="token plain">create stream evens;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">create stream odds;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># branch input into even/odd sequenced events using where clause</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select { &quot;even&quot;: event } from in where (event.seq_num %2 == 1) into evens;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select { &quot;odd&quot;: event } from in where (event.seq_num %2 == 0) into odds;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># combine / union evens and odds into standard out stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from evens into out;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from odds into out;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>We can test this with a json event using the <code>tremor</code> command line tool</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;seq_num&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;value&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;group&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;horse&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Assuming the trickle query is stored in a file called <code>evenodd.trickle</code> with the sample event
in a file called <code>data.json</code></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ tremor run evenodd.trickle -i data.json</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The command line tool will inject all events from the file provided by the <code>-i</code> argument and we would
expect to see output from the tool as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;odd&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;seq_num&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&quot;value&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&quot;group&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;horse&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="scripts-and-operators"></a>Scripts and Operators<a class="hash-link" href="#scripts-and-operators" title="Direct link to heading">#</a></h2><p>Here&#x27;s the logic for an entire backpressure algorithm that could be introduced as
a proxy between two systems, implemented by using a builtin operator called <a href="/docs/next/scripting/tremor-query/operators#qosbackpressure"><code>qos::backpressure</code></a>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly trickle"><pre tabindex="0" class="prism-code language-trickle codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">define qos::backpressure operator bp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">with</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    timeout = 10000,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps = [ 1, 50, 100, 250, 750 ],</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">create operator bp from bp;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from in into bp;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from bp into out;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>A slightly more complex example that uses both operators and the tremor scripting language
with the query language all together:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly tremor"><pre tabindex="0" class="prism-code language-tremor codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">define grouper::bucket operator kfc;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">define script categorize</span></span><span class="token-line" style="color:#393A34"><span class="token plain">script</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  let $rate = 1;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  let $class = event.`group`;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  { &quot;event&quot;: event, &quot;rate&quot;: $rate, &quot;class&quot;: $class };</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">create operator kfc from kfc;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># where script definition and instance name are the same, we can</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># omit the from clause in operator and script &#x27;create&#x27; statements</span></span><span class="token-line" style="color:#393A34"><span class="token plain">create script categorize;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># Stream ingested data into categorize script</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from in into categorize;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># Stream scripted events into kfc bucket operator</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from categorize into kfc;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># Stream bucketed events into out stream</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from kfc into out;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Operators are defined as <code>&lt;module&gt;::&lt;name&gt;</code> in the
context of an operator definition clause. Operators, like script definitions can take arguments.</p><p>Definitions in tremor are non-executing. They should be considered as templates or specifications.</p><p>In the query language, any <code>define</code> clause creates specifications, possibly with arguments for
specialization. They are typically incarnated via the <code>create</code> clause. Anything that is <code>create</code>ed
will form a stream or node in the query graph - these <em>do</em> consume memory and participate in a
pipeline query algorithm.</p><p>So in the above example, the <code>categorize</code> script and the <code>categorize</code> node have both a definition
or specification <strong>and</strong> an instance node that participates in the graph at runtime. It is often
convenient to use the same name where there is only one instance of an operator of a given type.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="building-query-graph-algorithms"></a>Building Query Graph Algorithms<a class="hash-link" href="#building-query-graph-algorithms" title="Direct link to heading">#</a></h2><p>Data streams can be branched and combined in the trickle query language via
the select statement. The resulting graphs must be acyclic with no direct or
indirect looping cycles.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="branching"></a>Branching<a class="hash-link" href="#branching" title="Direct link to heading">#</a></h3><p>Branching data streams to multiple streams is performed via select operations</p><p>Branch data into 3 different output stream ports</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly tremor"><pre tabindex="0" class="prism-code language-tremor codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">select event from in into out/a;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from in into out/b;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from in into out/c;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Branch data into 3 different intermediate streams</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly tremor"><pre tabindex="0" class="prism-code language-tremor codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">create stream a;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">create stream b;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">create stream c;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from in into a;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from in into b;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from in into c;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="combining"></a>Combining<a class="hash-link" href="#combining" title="Direct link to heading">#</a></h2><p>Multiple data streams can also be combined via select operations.</p><p>Combine 3 data streams into a single output stream</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly tremor"><pre tabindex="0" class="prism-code language-tremor codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">...</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from a into out;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from b into out;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from c into out;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Combine 3 data stream ports from 1 or many streams into a single output stream</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly tremor"><pre tabindex="0" class="prism-code language-tremor codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">...</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from a/1 into out;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from a/2 into out;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select event from b into out;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="aggregations"></a>Aggregations<a class="hash-link" href="#aggregations" title="Direct link to heading">#</a></h2><p>A key feature of the tremor query language are aggregations. These are supported with:</p><ul><li>Windows - A window is a range of events, clock or data time. There can be many different types of windows.</li><li>Aggregate functions - An aggregate function is a function that runs in the context of a window of events, emitting results intermittently</li><li>Tilt Frames - A tilt frame is a chain of compatible windows with <strong>decreasing</strong> resolution used to reduce memory pressure and preserve relative accuracy of windowed aggregate functions</li></ul><p>An example clock-driven tumbling window:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">define tumbling window `15secs`</span></span><span class="token-line" style="color:#393A34"><span class="token plain">with</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   interval = core::datetime::with_seconds(15),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;count&quot;: aggr::stats::count(), # Aggregate &#x27;count&#x27; function</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;min&quot;: aggr::stats::min(event.value),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;max&quot;: aggr::stats::max(event.value),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;mean&quot;: aggr::stats::mean(event.value),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;stdev&quot;: aggr::stats::stdev(event.value),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;var&quot;: aggr::stats::var(event.value),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">from in[`15secs`] # We apply the window nominally to streams</span></span><span class="token-line" style="color:#393A34"><span class="token plain">into out;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>To use a window we need to define the window specifications, such as a 15 second clock-based
tumbling window called <code>15secs</code> as above. We can then create instances of these windows at runtime by
applying those windows to streams. This is done in the <code>from</code> clause of a <code>select</code> statement.</p><p>Wherever windows are applied, aggregate functions can be used. In the above example, we are calculating
the minimum, maximum, average, standard deviation and variance of a <code>value</code> numeric field in data streaming
into the query via the standard input stream.</p><p>The query language is not constrained to clock-driven window definitions. Windows can also be
data-driven or fully programmatic.</p><p>A more complete example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly tremor"><pre tabindex="0" class="prism-code language-tremor codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">select {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;measurement&quot;: event.measurement,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;tags&quot;: patch event.tags of insert &quot;window&quot; =&gt; window end,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;stats&quot;: aggr::stats::hdr(event.fields[group[2]], [ &quot;0.5&quot;, &quot;0.9&quot;, &quot;0.99&quot;, &quot;0.999&quot; ]),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;class&quot;: group[2],</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;timestamp&quot;: aggr::win::first(event.timestamp),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">from in[`10secs`, `1min`, `10min`, `1h`]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">where event.measurement == &quot;udp_lb_test&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   or event.measurement == &quot;kafka-proxy.endpoints&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   or event.measurement == &quot;burrow_group&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   or event.measurement == &quot;burrow_partition&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   or event.measurement == &quot;burrow_topic&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">group by set(event.measurement, event.tags, each(record::keys(event.fields)))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">into normalize;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In the above example we use a single aggregate function called <code>aggr::stats::hdr</code> which uses a high dynamic range
or HDR Histogram to compute quantile estimates and basic statistics against a number of dynamic grouping fields
set by the <code>group</code> clause. A group clause effectively partitions our operation by the group expressions provided
by the trickle query programmer. In the example, we&#x27;re using the field names of the nested &#x27;fields&#x27; record on inbound
events to compose a component of a group that is also qualified by tags and a measurement name. The field component
is used as a numeric input to the histogram aggregate function.</p><p>In the <code>from</code> clause, we are using a tilt frame, or a succession of window resolutions over which this aggregate
function is producing results. So a <code>10secs</code> window is emitting on a 10-second repeating basis into a <code>1min</code> frame.
So 6 times per second the state of the 10 second window is merged into the <code>1min</code> frame. This merge process is
performed for each frame in the tilt frame.</p><p>The advantage of tilt-frames is that as the target expression is <strong>the same</strong> for each frame, we can <em>merge</em> across
each frame without amplifying error - in short, we get the <strong>effect</strong> of summarisation without loss of accuracy.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="aggregation-mechanics"></a>Aggregation Mechanics<a class="hash-link" href="#aggregation-mechanics" title="Direct link to heading">#</a></h2><p>The mechanics of aggregation in the query language are non-trivial.</p><p>A high level non-normative summary follows.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="windowing"></a>Windowing<a class="hash-link" href="#windowing" title="Direct link to heading">#</a></h3><p>Assuming a periodic event delivered every 2 seconds into tremor.</p><p><img alt="tumbling-event-windows.png" src="/assets/images/tumbling-event-windows-0c396bde4a1226bc661003e2bfee0ebd.png"></p><p>A size based window of size 2 would emit a synthetic output event every 2 events.
So the lifespan of a size based window is 2 events, repeated and non-overlapping for tumbling style windows.
In the illustration above events <code>1</code> and <code>2</code> in the first window <code>w0</code> produce a single synthetic or derivate event <code>a</code>
Events <code>3</code> and <code>4</code> in the second window <code>w1</code> produce a single synthetic or derivate event <code>b</code>
As there is no 6th event in the example illustration, we will <em>never</em> get another synthetic output event</p><p>Contrast this with the 10 second or clock-based tumbling window. In the first window <code>w0</code>s lifetime we capture
all events in the illustration.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="tilt-frames"></a>Tilt Frames<a class="hash-link" href="#tilt-frames" title="Direct link to heading">#</a></h3><p>Assuming a continuous flow of events into tremor...</p><p><img alt="tilt-frame-mechanics.png" src="/assets/images/tilt-frame-mechanics-ad37cfa0eab92e84ec9838c364ceef1b.png"></p><p>All the synthetic outputs of successive 5 minute windows that fit into a 15 minute interval are <strong>merged</strong>
into the 15 minute window. All the outputs of successive 15 minute intervals that fit into a 1 hour interval
are <strong>merged</strong> into the 1 hour window. By chaining and merging, tremor can optimise ( reduce ) the amount
of memory required across the chain when compared to multiple independent windows <code>select</code> expressions.
In the case of aggregate functions like <code>aggr::stats::hdr`` or</code>aggr::stats::dds``` the savings are significant.</p><p>If we imagine 1M events per second, that is 300M events every 5 minutes. 900M every 15, 3.6B every hour.</p><p>By using tilt frames we can maximally minimize internal memory consumption, whilst reducing the volume of
incremental computation ( per event, per frame ), and further whilst preserving relative accuracy for
merge-capable aggregate functions.</p><p>The converged statistics under merge exhibit the same relative accuracy at a fraction of the computational
and memory overhead without the using the tilt-frame mechanism.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="group-mechanics"></a>Group Mechanics<a class="hash-link" href="#group-mechanics" title="Direct link to heading">#</a></h2><p>The <code>group by</code> clause in the query language partitions streams before windows and tilt frames
are applied. Groups can be set-based, each-based or composites thereof.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="set-based-grouping"></a>Set based grouping<a class="hash-link" href="#set-based-grouping" title="Direct link to heading">#</a></h3><p>Grouping by set partitions streams by a concatenation of expressions.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly tremor"><pre tabindex="0" class="prism-code language-tremor codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">select event from in</span></span><span class="token-line" style="color:#393A34"><span class="token plain">group by set(event.country, event.region)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">into out;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In the example expression we are partitioning into a composite group that is
composed of the country and region of each inbound event.</p><p>So we expect data of the following form</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;country&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;US&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;region&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;east&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;az&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ... </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;country&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;US&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;region&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;east&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;az&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ... </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="each-based-grouping"></a>Each based grouping<a class="hash-link" href="#each-based-grouping" title="Direct link to heading">#</a></h3><p>Given that our data can be nested, however, our data could be structured differently:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;country&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;US&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  regions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;east&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly tremor"><pre tabindex="0" class="prism-code language-tremor codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">select event from in</span></span><span class="token-line" style="color:#393A34"><span class="token plain">group by each(record::keys(event.regions))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">into out;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Each field in the nested <code>locations</code> field becomes a component of our
set and qualified by country ...</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="limitations"></a>Limitations<a class="hash-link" href="#limitations" title="Direct link to heading">#</a></h3><p>There are cases however that are currently complex to partition with a
single select statement due to limitations with the grouping clause. For example
what if we wanted to make availability zones a component of our group partitions?</p><p>How would we structure such a query?</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;country&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;US&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  regions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;east&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> # AZs by region</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly tremor"><pre tabindex="0" class="prism-code language-tremor codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">create stream by_country_region;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">select { &quot;country&quot;: event.country, &quot;region&quot;: group[0], &quot;azs&quot;: event.regions[group[0]] }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">from in</span></span><span class="token-line" style="color:#393A34"><span class="token plain">group by each(record::keys(event.regions))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">into by_country_region;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>We can preprocess our inbound stream and collapse our locations
sub-record a single level by hoisting the <code>region</code> field to the
top level of a synthetic intermediate outbound stream <code>by_country_region</code>.</p><p>We can postprocess the intermediate stream <code>by_country_region</code> into a
single outbound stream that further extracts and hoists the &#x27;az&#x27; dimension</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly tremor"><pre tabindex="0" class="prism-code language-tremor codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">select { &quot;country&quot;: event.country, &quot;region&quot;: event.region, &quot;az&quot;: group[0], }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">from by_country_region</span></span><span class="token-line" style="color:#393A34"><span class="token plain">group by each(event.azs)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">into out;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>So, we need 2 select statements to compose a solution where there are multiple
nesting levels via successive extraction of group components. The same principle
works with more complex grouping requirements.</p><p>Once the grouping mechanics are resolved, windowing, aggregation and tilt-frames
can be applied to further refine queries.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/tremor-rs/tremor-www/tree/main/docs/scripting/tremor-query/walkthrough.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/next/scripting/tremor-query/index"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Tremor-Query</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/next/scripting/tremor-query/operators"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Operators Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a></li><li><a href="#scripts-and-operators" class="table-of-contents__link">Scripts and Operators</a></li><li><a href="#building-query-graph-algorithms" class="table-of-contents__link">Building Query Graph Algorithms</a><ul><li><a href="#branching" class="table-of-contents__link">Branching</a></li></ul></li><li><a href="#combining" class="table-of-contents__link">Combining</a></li><li><a href="#aggregations" class="table-of-contents__link">Aggregations</a></li><li><a href="#aggregation-mechanics" class="table-of-contents__link">Aggregation Mechanics</a><ul><li><a href="#windowing" class="table-of-contents__link">Windowing</a></li><li><a href="#tilt-frames" class="table-of-contents__link">Tilt Frames</a></li></ul></li><li><a href="#group-mechanics" class="table-of-contents__link">Group Mechanics</a><ul><li><a href="#set-based-grouping" class="table-of-contents__link">Set based grouping</a></li><li><a href="#each-based-grouping" class="table-of-contents__link">Each based grouping</a></li><li><a href="#limitations" class="table-of-contents__link">Limitations</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/quick-start/">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/community/faqs">FAQs</a></li><li class="footer__item"><a class="footer__link-item" href="/api/0">Tremor API</a></li><li class="footer__item"><a class="footer__link-item" href="/community/governance/CodeofConduct">Code of Conduct</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://chat.tremor.rs/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/TremorDEBS" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/tremor-rs/tremor-runtime/releases" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Download<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.cncf.io/" target="_blank" rel="noreferrer noopener" aria-label="CNCF"><img src="/img/cncf-color.svg" alt="CNCF" style="width: 200px;"></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/favicon.ico" alt="Tremor Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/favicon.ico" alt="Tremor Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></div><div class="footer__copyright">Copyright Â© 2021 Tremor</div></div></div></footer></div>
<script src="/assets/js/runtime~main.7fca1092.js"></script>
<script src="/assets/js/main.34faea97.js"></script>
</body>
</html>