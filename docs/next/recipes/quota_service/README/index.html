<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.ff31de0ff">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Tremor Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Tremor Blog Atom Feed"><title data-react-helmet="true">Quota Service | Tremor</title><meta data-react-helmet="true" property="og:url" content="https://www.tremor.rs//docs/next/recipes/quota_service/README"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Quota Service | Tremor"><meta data-react-helmet="true" name="description" content="Demo quota service, geared for a log collection usecase (but can be applied for similar needs elsewhere too)."><meta data-react-helmet="true" property="og:description" content="Demo quota service, geared for a log collection usecase (but can be applied for similar needs elsewhere too)."><link data-react-helmet="true" rel="shortcut icon" href="/docs/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://www.tremor.rs//docs/next/recipes/quota_service/README"><link data-react-helmet="true" rel="alternate" href="https://www.tremor.rs//docs/next/recipes/quota_service/README" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://www.tremor.rs//docs/next/recipes/quota_service/README" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.772104c2.css">
<link rel="preload" href="/assets/js/runtime~main.7c6d918c.js" as="script">
<link rel="preload" href="/assets/js/main.34d2faf0.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.tremor.rs/" target="_self" rel="noopener noreferrer" class="navbar__brand"><img src="/img/tremor-logo.svg" alt="Tremor Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/tremor-logo.svg" alt="Tremor Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a class="navbar__item navbar__link" href="/getting-started/about/">About Us</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/next/index">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/quick-start">Usage Guide</a><a class="navbar__item navbar__link" href="/api/0">API</a><a class="navbar__item navbar__link" href="/rfc/index">RFCs</a><a class="navbar__item navbar__link" href="/community/community">Community</a><a class="navbar__item navbar__link" href="/community/governance">Governance</a><a class="navbar__item navbar__link" href="/faqs">FAQs</a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link" href="/docs/next/index">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/next/recipes/quota_service/README">Next</a></li><li><a class="dropdown__link" href="/docs/recipes/quota_service/README">0.11</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub">GitHub</a><div class="searchWrapper_3rmH"><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div></div><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a href="https://www.tremor.rs/" target="_self" rel="noopener noreferrer" class="navbar__brand"><img src="/img/tremor-logo.svg" alt="Tremor Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/tremor-logo.svg" alt="Tremor Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/getting-started/about/">About Us</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/next/index">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/quick-start">Usage Guide</a></li><li class="menu__list-item"><a class="menu__link" href="/api/0">API</a></li><li class="menu__list-item"><a class="menu__link" href="/rfc/index">RFCs</a></li><li class="menu__list-item"><a class="menu__link" href="/community/community">Community</a></li><li class="menu__list-item"><a class="menu__link" href="/community/governance">Governance</a></li><li class="menu__list-item"><a class="menu__link" href="/faqs">FAQs</a></li><li class="menu__list-item"><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub">GitHub</a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/next/recipes/quota_service/README">Next</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/recipes/quota_service/README">0.11</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/next/index">Tremor</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/next/overview">Architecture Overview</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/next/ConstraintsLimitations">Constraints and Limitations</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Recepies</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">passthrough</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/passthrough/README">Passthrough</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">filter</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/filter/README">Filter</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">transform</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/transform/README">Transform</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">validate</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/validate/README">Transform</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">logstash</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/logstash/README">Transform</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">influx</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/influx/README">Transform</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">postgres_timescaledb</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/postgres_timescaledb/README">Transform</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">grafana</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/grafana/README">Transform</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">syslog_udp</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/syslog_udp/README">syslog udp</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">syslog_udp_dns</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/syslog_udp_dns/README">syslog udp dns</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">transient_gd</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/transient_gd/README">Transient Write-Ahead Log</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">persistent_gd</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/persistent_gd/README">Persistent Write-Ahead Log</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">roundrobin</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/roundrobin/README">Round Robin</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">kafka_gd</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/kafka_gd/README">Kafka delivery guarantees</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">servers_lt_http</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/servers_lt_http/README">HTTP Server</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">servers_lt_ws</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/servers_lt_ws/README">Websocket Server</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">proxies_lt_http</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/proxies_lt_http/README">HTTP Proxy</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">proxies_lt_ws</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/proxies_lt_ws/README">Websocket Proxy</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">bridges_lt_http_ws</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/bridges_lt_http_ws/README">HTTP -&gt; Websocket Bridge</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">reverse_proxy_load_balancing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/reverse_proxy_load_balancing/README">Reverse proxy with Load Balancing</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">quota_service</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/next/recipes/quota_service/README">Quota Service</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">configurator</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/configurator/README">Configurator</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">polling_alerts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/polling_alerts/README">Polling</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">kafka_elastic_correlation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/kafka_elastic_correlation/README">Ingesting documents from kafka into elastic</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">otel_passthrough</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/otel_passthrough/README">CNCF OpenTelemetry Passthrough</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">otel_zipkin</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/otel_zipkin/README">CNCF OpenTelemetry Zipkin Interworking</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">otel_jaeger</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/otel_jaeger/README">CNCF OpenTelemetry Jaeger Interworking</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">otel_prometheus</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/otel_prometheus/README">CNCF OpenTelemetry Prometheus Interworking</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">otel_elastic_apm</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/recipes/otel_elastic_apm/README">CNCF OpenTelemetry Elastic APM Interworking</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/recipes/README">Tremor Workshop</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Operations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/operations/cli">Tremor cli v0.11</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/operations/configuration-walkthrough">Configuration Walkthrough</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/operations/configuration">Configuring Tremor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/operations/gdcb">Circuit Breakers and Guaranteed Delivery</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/operations/linked-transports">Linked Transports</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/operations/monitoring">Monitoring</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Artefacts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/artefacts/codecs">Codecs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/artefacts/offramps">Offramps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/artefacts/onramps">Onramps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/artefacts/postprocessors">Postprocessors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/artefacts/preprocessors">Preprocessors</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tremor Script</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/extractors">Extractors</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">extractors</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/extractors/base64">Base64</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/extractors/cidr">CIDR</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/extractors/datetime">Datetime</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/extractors/dissect">Dissect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/extractors/glob">Glob</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/extractors/grok">Grok</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/extractors/influx">Influx</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/extractors/json">JSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/extractors/kv">KV</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/extractors/regex">Regex (re)</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/functions">Functions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/index">Tremor-Script</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/modules">Modules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/pp">pp</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/recipes">Recipes</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">stdlib</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/cncf">cncf</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">cncf</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/cncf/otel">otel</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">otel</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/cncf/otel/logs">logs</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">logs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/cncf/otel/logs/severity">severity</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/cncf/otel/logs/traceflags">traceflags</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/cncf/otel/metrics">metrics</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">metrics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/cncf/otel/metrics/temporality">temporality</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/cncf/otel/span_id">span_id</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/cncf/otel/trace">trace</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">trace</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/cncf/otel/trace/spankind">spankind</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/cncf/otel/trace/status">status</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/cncf/otel/trace_id">trace_id</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std">std</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">std</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/array">array</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/base64">base64</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/binary">binary</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/float">float</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/integer">integer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/json">json</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/math">math</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/path">path</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/random">random</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/range">range</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/re">re</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/record">record</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/string">string</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/test">test</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/type">type</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/url">url</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/std/win">win</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/tremor">tremor</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">tremor</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/tremor/chash">chash</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/tremor/origin">origin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-script/stdlib/tremor/system">system</a></li></ul></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tremor Query</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-query/functions">Aggregate Functions</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">functions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-query/functions/stats">The `stats` namespace</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-query/functions/win">The `win` namespace</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-query/index">Tremor-Query</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-query/modules">Modules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-query/operators">Operators</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-query/pp">pp</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-query/recipes">Periodic Synthetic Metrics Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tremor-query/walkthrough">Trickle Walkthough</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/next/history">History</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/next/Glossary">Glossary of Terms</a></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for Tremor <strong>Next</strong> version.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/docs/recipes/quota_service/README">latest version</a></strong> (0.11).</div></div><div class="docItemContainer_33ec"><article><div><span class="badge badge--secondary">Version: Next</span></div><header><h1 class="docTitle_3a4h">Quota Service</h1></header><div class="markdown"><p>Demo quota service, geared for a log collection usecase (but can be applied for similar needs elsewhere too).</p><p>This is a HTTP CRUD application running alongside an example log receiver setup (logs in via TCP -&gt; tremor -&gt; elastic out), that allows operators to update the throttling rates for various classes of logs. It also allows retrieving the current quotas for all classes, which can potentially be used by logging clients to pre-throttle on their end, even before transmitting the logs to tremor (or the information can be used to always provide up-to-date quota limits to folks using this log platform).</p><p>The application itself is written on top of tremor, utilizing the <a href="/docs/next/operations/linked-transports">linked transports</a> feature introduced in Tremor 0.9 and the <a href="/docs/next/artefacts/offramps#kv">KV offramp</a> introduced in Tremor 0.11.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="setup"></a>Setup<a class="hash-link" href="#setup" title="Direct link to heading">#</a></h2><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>All the application code here is available from the docs <a href="https://github.com/tremor-rs/tremor-www-docs/tree/main/docs/workshop/examples/36_quota_service" target="_blank" rel="noopener noreferrer">git repository</a>.</p></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># needed for elasticsearch container to start successfully</span></div><div class="token-line" style="color:#393A34"><span class="token plain"># https://www.elastic.co/guide/en/elasticsearch/reference/current/docker.html#_set_vm_max_map_count_to_at_least_262144</span></div><div class="token-line" style="color:#393A34"><span class="token plain">sudo sysctl -w vm.max_map_count=262144</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"># start everything (tremor/elasticsearch/kibana)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">docker-compose up</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Following services should now be accessible:</p><ul><li>Quota Service: (Tremor) <a href="http://localhost:8139" target="_blank" rel="noopener noreferrer">http://locahost:8139</a></li><li>Log receiver (Tremor): tcp://localhost:12202</li><li>Elasticsearch: <a href="http://localhost:9200" target="_blank" rel="noopener noreferrer">http://locahost:9200</a></li><li>Kibana: <a href="http://localhost:5601/" target="_blank" rel="noopener noreferrer">http://localhost:5601/</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="log-ingestion"></a>Log Ingestion<a class="hash-link" href="#log-ingestion" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># send logs periodically to the tcp log receiver port (powered by tremor)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">./logger.sh | nc localhost 12202</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>You should now see an elasticsearch index (<code>test_logs</code>) being created with the logs. Example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">$ curl localhost:9200/_cat/indices</span></div><div class="token-line" style="color:#393A34"><span class="token plain">yellow open test_logs xtdBODqGQ7Gub1PfUlcaWA 5 1 788 0  139kb  139kb</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>You can also inspect/visualize the logs from kibana. Create an index pattern <a href="http://localhost:5601/app/kibana#/management/kibana/index" target="_blank" rel="noopener noreferrer">here</a> (eg: <code>test_logs*</code>), choosing <code>ingestion_timestamp</code> as the time field -- this allows timeseries navigation in the <a href="http://localhost:5601/app/kibana#/discover" target="_blank" rel="noopener noreferrer">Discover</a> page as the logs are ingested (useful since we are replaying old log data dump).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="using-the-quota-service"></a>Using the Quota Service<a class="hash-link" href="#using-the-quota-service" title="Direct link to heading">#</a></h2><p><strong>List routes</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">$ curl http://localhost:8139</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      Welcome to the Logging Quota Service!</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      Available routes:</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      GET /quotas</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      GET /quotas/&lt;quota_name&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      PUT /quotas/&lt;quota_name&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      DELETE /quotas/&lt;quota_name&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      HEAD /ping</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      * /echo</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>Get quotas</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># populated from file etc/tremor/data/quotas.json on startup</span></div><div class="token-line" style="color:#393A34"><span class="token plain"># output is keyed by class name (the details of the classification are defined in etc/tremor/config/logs.trickle)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">$ curl -XGET localhost:8139/quotas</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{&quot;host_default&quot;:500,&quot;logger_default&quot;:50,&quot;index_default&quot;:100,&quot;tremolo&quot;:100,&quot;application_default&quot;:100}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"># it is also possible to get single quotas</span></div><div class="token-line" style="color:#393A34"><span class="token plain">$ curl -XGET localhost:8139/quotas/index_default</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{&quot;index_default&quot;:100}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>Set quotas</strong></p><p>Changes to quotas are applied immediately, no scheduled reads of the quotas are necessary, no downtime to change configuration is required. What we get is updated quota handling in real-time:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain"># set rate for tremolo class of logs to 1 message per second</span></div><div class="token-line" style="color:#393A34"><span class="token plain"># returns the old, overwritten state on success</span></div><div class="token-line" style="color:#393A34"><span class="token plain">$ curl -XPUT -H&#x27;Content-Type: application/json&#x27; &quot;http://localhost:8139/quotas/tremolo&quot; -d&#x27;1&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{&quot;tremolo&quot;: 100}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"># If you are monitoring the tremolo logs from kibana, you should now see the (debug) field `tremor_class_rate` change to 1 (from 100).</span></div><div class="token-line" style="color:#393A34"><span class="token plain"># More importantly, the log volume visible there should have also decreased.</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"># to remove the rate override for a given quota (i.e. switch to the default, hard-coded rate)</span></div><div class="token-line" style="color:#393A34"><span class="token plain"># curl -XDELETE http://localhost:8139/quotas/tremolo</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Example kibana view demonstrating the change in number of tremolo logs, after setting the quota dynamically from the above api:</p><blockquote><p><img alt="Kibana View for Quota Service Demo" src="/assets/images/tremor_quota_service_demo-e2a62ed11ce449919dbd20396b045610.png"></p></blockquote><p><strong>Debug request</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">$ curl -XPOST localhost:8139/echo -d&#x27;{&quot;snot&quot;: &quot;badger&quot;}&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{&quot;body&quot;:&quot;{\&quot;snot\&quot;: \&quot;badger\&quot;}&quot;,&quot;meta&quot;:{&quot;method&quot;:&quot;POST&quot;,&quot;headers&quot;:{&quot;content-length&quot;:[&quot;18&quot;],&quot;content-type&quot;:[&quot;application/x-www-form-urlencoded&quot;],&quot;user-agent&quot;:[&quot;curl/7.65.3&quot;],&quot;accept&quot;:[&quot;*/*&quot;],&quot;host&quot;:[&quot;localhost:8139&quot;]},&quot;url&quot;:{&quot;scheme&quot;:&quot;http&quot;,&quot;host&quot;:&quot;localhost&quot;,&quot;port&quot;:8139,&quot;path&quot;:&quot;/echo&quot;}}}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/tremor-rs/tremor-new-website/tree/main/docs/recipes/36_quota_service/README.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/next/recipes/reverse_proxy_load_balancing/README"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Reverse proxy with Load Balancing</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/next/recipes/configurator/README"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configurator Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#setup" class="table-of-contents__link">Setup</a></li><li><a href="#log-ingestion" class="table-of-contents__link">Log Ingestion</a></li><li><a href="#using-the-quota-service" class="table-of-contents__link">Using the Quota Service</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/quick-start/">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/faqs/">FAQs</a></li><li class="footer__item"><a class="footer__link-item" href="/api/0">Tremor API</a></li><li class="footer__item"><a class="footer__link-item" href="/community/governance/CodeofConduct">Code of Conduct</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://chat.tremor.rs/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/TremorDEBS" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://github.com/tremor-rs/tremor-runtime/releases" target="_blank" rel="noopener noreferrer" class="footer__link-item">Download</a></li><li class="footer__item"><a href="https://www.cncf.io/" target="_blank" rel="noreferrer noopener" aria-label="CNCF"><img src="/img/cncf-color.svg" alt="CNCF" style="width: 200px;"></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/favicon.ico" alt="Tremor Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/favicon.ico" alt="Tremor Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></div><div class="footer__copyright">Copyright Â© 2021 Tremor</div></div></div></footer></div>
<script src="/assets/js/runtime~main.7c6d918c.js"></script>
<script src="/assets/js/main.34d2faf0.js"></script>
</body>
</html>